<!-- Modal para Agregar Producto -->
<div *ngIf="nuevoProducto" class="fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center z-50">
  <div class="bg-white rounded-lg shadow-lg p-6 w-full max-w-3xl relative">
    <!-- Título del modal -->
    <h2 class="text-2xl font-bold text-gray-800 mb-6 border-b pb-3">Agregar Producto</h2>

    <!-- Formulario -->
    <form (ngSubmit)="agregarProducto()" #form="ngForm">
      
      <!-- Campo para subir la foto -->
      <div class="mb-6 flex flex-col items-center">
        <label for="file-input-upload" class="w-full h-36 flex flex-col items-center justify-center border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-blue-500 transition duration-200">
          <img *ngIf="!imagePreview" src="assets/images/Agregar.jpg" alt="imagen referente" class="h-12 mb-2 opacity-70 hover:opacity-100 transition duration-200" />
          <img *ngIf="imagePreview" [src]="imagePreview" alt="Previsualización de la imagen" class="h-12 mb-2 opacity-100 transition duration-200" />
          <span class="text-gray-600 text-sm">Seleccionar imagen</span>
        </label>
        <input type="file" (change)="onFileSelected($event)" accept="image/*" name="image" id="file-input-upload" required class="hidden" />
      </div>

      <!-- Campos del producto -->
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
        <!-- Código del Producto -->
        <div>
          <label for="code_product" class="block text-sm font-medium text-gray-700 mb-1">Código del Producto</label>
          <input [(ngModel)]="nuevoProducto.codeProduct" id="code_product" name="code_product" required class="border border-gray-300 rounded-md w-full p-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Ingresa el código" />
        </div>

        <!-- Nombre del Producto -->
        <div>
          <label for="name" class="block text-sm font-medium text-gray-700 mb-1">Nombre del Producto</label>
          <input [(ngModel)]="nuevoProducto.name" id="name" name="name" required class="border border-gray-300 rounded-md w-full p-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Ingresa el nombre" />
        </div>

       <!-- Precio de Venta -->
<div>
  <label for="sale_price" class="block text-sm font-medium text-gray-700 mb-1">Precio de Venta</label>
  <input 
    type="number" 
    [(ngModel)]="nuevoProducto.salePrice" 
    id="sale_price" 
    name="sale_price" 
    required 
    min="0.01" 
    class="border border-gray-300 rounded-md w-full p-2 focus:ring-blue-500 focus:border-blue-500" 
    placeholder="Precio de venta" 
    #salePrice="ngModel" />
  <div *ngIf="salePrice?.invalid && salePrice?.touched" class="text-red-500 text-sm mt-1">
    El precio debe ser mayor que cero.
  </div>
</div>

<!-- Precio de compra -->
<div>
  <label for="purchasePrice" class="block text-sm font-medium text-gray-700 mb-1">Precio de Compra</label>
  <input 
    type="number" 
    [(ngModel)]="nuevoProducto.purchasePrice" 
    id="purchasePrice" 
    name="purchasePrice" 
    required 
    min="0.01" 
    class="border border-gray-300 rounded-md w-full p-2 focus:ring-blue-500 focus:border-blue-500" 
    placeholder="Precio de compra" 
    #purchasePrice="ngModel" />
  <div *ngIf="purchasePrice?.invalid && purchasePrice?.touched" class="text-red-500 text-sm mt-1">
    El precio debe ser mayor que cero.
  </div>
</div>




        <!-- Proveedor (Select) -->
        <div>
          <label for="supplier_id" class="block text-sm font-medium text-gray-700 mb-1">Proveedor</label>
          <select [(ngModel)]="nuevoProducto.supplierId" id="supplier_id" name="supplier_id" required class="border border-gray-300 rounded-md w-full p-2 focus:ring-blue-500 focus:border-blue-500">
            <option *ngFor="let supplier of proveedores" [value]="supplier.id">{{ supplier.name }}</option>
          </select>
        </div>

        <!-- Categoría (Select) -->
        <div>
          <label for="categories_products_id" class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
          <select [(ngModel)]="nuevoProducto.categoriesProductsId" id="categories_products_id" name="categoriesProductsId" required class="border border-gray-300 rounded-md w-full p-2 focus:ring-blue-500 focus:border-blue-500">
            <option *ngFor="let categoria of categorias" [value]="categoria.id">{{ categoria.name }}</option>
          </select>
        </div>

        <!-- Cantidad en Stock -->
<div>
  <label for="amount" class="block text-sm font-medium text-gray-700 mb-1">Cantidad en Stock</label>
  <input 
    type="number" 
    [(ngModel)]="nuevoProducto.amount" 
    id="amount" 
    name="amount" 
    required 
    min="1" 
    class="border border-gray-300 rounded-md w-full p-2 focus:ring-blue-500 focus:border-blue-500" 
    placeholder="Cantidad disponible" 
    #amount="ngModel" />
  <div *ngIf="amount?.invalid && amount?.touched" class="text-red-500 text-sm mt-1">
    La cantidad debe ser mayor que cero.
  </div>
</div>

        <!-- Estado -->
        <div>
          <label for="state" class="block text-sm font-medium text-gray-700 mb-1">Estado</label>
          <select [(ngModel)]="nuevoProducto.state" id="state" name="state" required class="border border-gray-300 rounded-md w-full p-2 focus:ring-blue-500 focus:border-blue-500">
            <option value="Activo">Activo</option>
            <option value="Inactivo">Inactivo</option>
          </select>
        </div>

        <!-- Descuento -->
        <div>
          <label for="descuento" class="block text-sm font-medium text-gray-700 mb-1">Descuento</label>
          <input type="number" [(ngModel)]="nuevoProducto.descuento" id="descuento" name="descuento" min="0" class="border border-gray-300 rounded-md w-full p-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Porcentaje de descuento" />
        </div>

         <!-- Fecha de Ingreso -->
         <div>
          <label for="fechaIngreso" class="block text-sm font-medium text-gray-700 mb-1">Fecha de Ingreso</label>
          <input type="date" [(ngModel)]="nuevoProducto.fechaIngreso" id="fechaIngreso" name="fechaIngreso" required class="border border-gray-300 rounded-md w-full p-2 focus:ring-blue-500 focus:border-blue-500" />
        </div>
      </div>

        <!-- Descripción -->
        <div class="col-span-full">
          <label for="description" class="block text-sm font-medium text-gray-700 mb-1">Descripción</label>
          <textarea [(ngModel)]="nuevoProducto.description" id="description" name="description" required class="border border-gray-300 rounded-md w-full p-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Descripción del producto"></textarea>
        </div>


      
      <!-- Botones de acción -->
      <div class="flex justify-end mt-6">
        <button type="submit" [disabled]="form.invalid" class="bg-blue-500 text-white font-semibold rounded-md py-2 px-4 hover:bg-blue-600 transition duration-200">
          Agregar
        </button>
        <button (click)="cerrar()" type="button" class="bg-gray-300 text-gray-800 font-semibold rounded-md py-2 px-4 hover:bg-gray-400 transition duration-200 ml-2">
          Cancelar
        </button>
      </div>
    </form>
  </div>
</div>
