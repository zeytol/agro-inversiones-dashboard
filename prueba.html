<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Editar Producto</title>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
  <h1>Editar Producto</h1>

  <!-- Campo para editar el nombre del producto -->
  <label for="product-name">Nombre del Producto:</label>
  <input type="text" id="product-name" value="Pesticidas2">
  <br><br>

  <!-- Campo para editar la descripción del producto -->
  <label for="product-description">Descripción del Producto:</label>
  <input type="text" id="product-description" value="Productos utilizados para controlar plagas en cultivos agrícolas.">
  <br><br>

  <!-- Campo para subir una nueva imagen -->
  <label for="product-image">Subir Imagen del Producto:</label>
  <input type="file" id="product-image" accept="image/*">
  <br><br>

  <!-- Botón para actualizar el producto -->
  <button id="update-btn">Actualizar Producto</button>

  <script>
    async function updateProduct() {
      // Obtener los valores de los campos
      const productName = document.getElementById('product-name').value;
      const productDescription = document.getElementById('product-description').value;

      // Obtener archivo de imagen (si se ha seleccionado uno nuevo)
      const imageInput = document.getElementById('product-image');
      const imageFile = imageInput.files[0];

      // Datos del producto a actualizar
      const productData = {
        "name": productName,
        "description": productDescription,
        "image": "" // Por defecto, no incluimos la imagen en los datos si no se selecciona una nueva
      };

      // Crear objeto FormData
      const formData = new FormData();
      formData.append("CatProduct", new Blob([JSON.stringify(productData)], { type: 'application/json' })); // Agregar datos del producto

      // Agregar la nueva imagen si se seleccionó
      if (imageFile) {
        formData.append("image", imageFile);
      }

      try {
        // Enviar los datos con multipart/form-data
        const response = await axios.put('https://agroinversiones-api-ffaxcadua6gwf0fs.canadacentral-01.azurewebsites.net/api/categories/edit/1', formData, {
          headers: { 'Content-Type': 'multipart/form-data' } // Asegúrate de usar el Content-Type correcto
        });
        alert(`Producto actualizado con éxito: ${JSON.stringify(response.data)}`);
      } catch (error) {
        console.error('Error al actualizar el producto:', error);
        alert(`Error al actualizar el producto: ${error.response ? error.response.data : error.message}`);
      }
    }

    // Vincular evento al botón
    document.getElementById('update-btn').addEventListener('click', updateProduct);
  </script>
</body>
</html>
